# Рекомендательный ИИ для интернет-магазина

Проблематика, кейс: необходима разработка интеллектуальной рекомендательной системы для интернет-магазина, которая позволит увеличить продажи

## Описание задачи:

() Исходя из данных о поведении посетителей на сайте интернет-магазина, необходимо разработать модель для рекомендации товаров пользователям. Модель должна предсказывать топ 25 товаров, которые пользователь купит с наибольшей вероятностью в следующие 3 дня (период тестового датасета). Метрикой качества является Recall по купленным товарам.
() Например, в сформированном вашей моделью списке из 25 товаров, оказалось 3 из 4х, которые пользователь реально купил. Recall для этого пользователя составит ¾ = 0.75.
Для пользователей из тестовой выборки, которым не нашлось соответствия в вашем прогнозе - Recall составит 0. Пример приведен на рисунке, где в поле products_y (прогнозные товары вашей модели) стоит значение NaN
При этом, топ товаров составляется ровно для 3000 пользователей, которые с наибольшей вероятностью совершат покупку. Т.е. ваш сабмит-файл не должен превышать 3000 объектов (пользователей) и должен соответствовать формату выгрузки, представленному в файле baseline.ipynb. В противном случает Recall посчитается, как ноль

## В распоряжении имеется 4 набора данных, содержащий следующие поля:

### stokman_catalog_preprocessed.pq

1) add_date - дата добавления товара в магазин
2) shop_id - идентификатор магазина
3) product_id - идентификатор товара
4) category_id - идентификатор категории товаров
5) price - цена
6) title - закодированное название товара (в файле vectors.npz содержатся эмбединги оригинальных названий)
7) old_price - старая цена

### train_actions.pq

1) user_id - глобальный идентификатор пользователя для подбора рекомендаций (формируется по cookies. Один пользователь может заходить с разных сайтов или устройств и иметь разные ID) 
2) loc_user_id - локальный идентификатор пользователя внутри сайта
3) action - код действия пользователя
4) date - дата и время действия
5)products - массив идентификаторов товаров, относящийся к действию
6) pageId - идентификатор страницы веб-сайта, с которой пользователь выполняет действие

### catalog_vector_mapping.pq

1) product_id - идентификатор товара
2) vector_id - идентификатор вектора содержащего эмбединг названия товара из файла vectors.npz

### vectors.npz - файл содержащий эмбединги названий товаров.
 
### Признак action в train_actions.pq имеет следующую расшифровку:

•	0 - view (просмотр товара)
•	1 - like (лайк товара)
•	2 - addB (добавление товара в корзину)
•	3 - delB (удаление товара из корзины)
•	4 - clearB (удаление всех товаров из корзины)
•	5 - order (оформление заказа)
•	6 - listB (посещение страницы корзины и вывод списка товаров в корзине)
•	7 - visit (посещение страницы магазина)
•	8 - visitCategory (посещение страницы с группой товаров)
•	9 - search (поиск товара)
 
## Общие требования:

#### Можно реализовать через собственный Python или консольный скрипт. Предпочтительно использовать workflow manager использующий DAG (snakemake или DVC)

1) Эксперимент, его результирующие артефакты и модель должны логироваться в MLFlow
2) Код (пайплайн) предобработки данных и обучения модели должен быть разбит на отдельные скрипты, запускающиеся с помощью одной команды в нужной последовательности.
3) Код должен быть написан в соответствии с PEP8
4) Зависимости проекта должны находиться под управлением одного из известных менеджеров и должны обеспечивать воспроизводимость эксперимента (pip, poetry)
5) Репозиторий должен быть обеспечен подробной инструкцией по запуску эксперимента в Readme файле
 
## Состав решения:

1) Презентация решения должна отражать
2) Описание исходных данных
3) Используемый технологический стек и инструменты
4) Методологию проведения экспериментов
5) Методы обработки исходных данных
6) Основные гипотезы, проверяемые в ходе экспериментов
7) Описание проверяемых алгоритмов/архитектур
8) Подбор гиперпараметров
9) Результаты валидации моделей
10) Выгрузка предсказаний модели на 3 дня в формате, представленном в файле baseline.ipynb
11) Репозиторий с Readme (на Github/Gitlab), включающий:
12) Инструкции по развертыванию и установке решения для инференса (если требуется)
13) Инструкции по запуску пайплайнов обработки даннных и обучения модели
14) Модель и артефакты эксперимента в MLFlow или другом registry для хранения моделей
